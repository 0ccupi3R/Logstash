filter {
  if [signature] !~ "SCAN" and [signature] !~ "POLICY" and [event_type] == "alert" {
    if [source_ip] {
      elasticsearch {
        query => "event_type:bro_dns AND answers:%{source_ip}"
        index => "logstash-level-two"
        fields => {
          "highest_registered_domain" => "source_highest_registered_domain"
          "query" => "source_fqdn"
        }
      }
    }
    if [destination_ip] {
      elasticsearch {
        query => "event_type:bro_dns AND answers:%{destination_ip}"
        index => "logstash-level-two"
        fields => {
          "highest_registered_domain" => "destination_highest_registered_domain"
          "query" => "destination_fqdn"
        }
      }
    }
  }
}
